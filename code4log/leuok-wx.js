!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e,t){e.exports=require("./leuok-wx-conf")},function(e,t,s){"use strict";s.r(t);var i={getRandom:()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1),getUUID(){let e="";for(let t=0;t<8;t++)e+=this.getRandom();return e},dateFormat(e,t="yyyy-MM-dd hh:mm:ss"){let s={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in s)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?s[e]:("00"+s[e]).substr((""+s[e]).length)));return t}};class n{constructor(e){this.uuid=e.uuid||"",this.uid=e.uuid||"",this.platId=e.platId,this.regionId=e.regionId,this.channelId=e.channelId,this.dt=i.dateFormat(new Date,"yyyy-MM-dd hh:mm:ss")}toString(){return`${this.uuid}|${this.uid}|${this.platId}|${this.regionId}|${this.channelId}|${this.dt}`}}class r{constructor(e){this.deviceId=e.uuid||"",this.ip=e.ip||"1.1.1.1",this.clientVersion=e.version||"",this.systemSoftware=e.system||"",this.systemHardware=e.model||"",this.comOperation=e.comOperation||0,this.network=e.network||0,this.cpuHardware=e.cpuHardware||"",this.gpuHardware=e.gpuHardware||"",this.memory=e.memory||0,this.screenWidth=e.screenWidth||"",this.screenHeight=e.screenHeight||"",this.density=e.pixelRatio||"",this.glRender=e.glRender||"",this.glVersion=e.glVersion||"",this.phoneNumber=e.phoneNumber||""}toString(){return this.deviceId+"|"+this.ip+"|"+this.clientVersion+"|"+this.systemSoftware+"|"+this.systemHardware+"|"+this.comOperation+"|"+this.network+"|"+this.cpuHardware+"|"+this.gpuHardware+"|"+this.memory+"|"+this.screenWidth+"|"+this.screenHeight+"|"+this.density+"|"+this.glRender+"|"+this.glVersion+"|"+this.phoneNumber}}class h extends n{constructor(e={},t={}){super(e,t),this.device=new r(e),this.reged=0,this.level=t.level||0}toString(){return`log_reg|${super.toString()}|${this.level}|${this.reged}|${this.device.toString()}`}}class o extends n{constructor(e,t){super(e),this.regDt=e.regDt||"",this.reged=0,this.level=t.level||0,this.vip=t.vip||0,this.payed=t.payed||0}toString(){return super.toString()+"|"+this.regDt+"|"+this.level+"|"+this.reged+"|"+this.vip+"|"+this.payed}}class u extends o{constructor(e={},t={}){super(e,t),this.device=new r(e),this.type=t.type||0,this.friendsNum=t.friendsNum||0,this.online=t.online||0,this.power=t.power||0,this.energy=t.energy||0,this.guildId=t.guildId||0,this.roleName=t.roleName||""}toString(){return`log_login|${super.toString()}|${this.device.toString()}|${this.type}|${this.friendsNum}|${this.online}|${this.power}|${this.energy}|${this.guildId}|${this.roleName}`}}class d extends o{constructor(e={},t={}){super(e,t),this.newPlayer=e.isReg?1:0,this.type=t.type||0}toString(){return`log_share_in|${super.toString()}|${this.type}|${this.newPlayer}`}}class a extends o{constructor(e={},t={}){super(e,t),this.type=t.type||0}toString(){return`log_share_out|${super.toString()}|${this.type}`}}class l extends o{constructor(e={},t={}){super(e,t),this.type=t.type||0,this.subType=t.subType||0}toString(){return`log_ad_video|${super.toString()}|${this.type}|${this.subType}`}}class p{constructor(e){this.uuid=e.uuid,this.uid=e.uuid,this.gameId=e.gameId,this.platId=e.platId,this.regionId=e.regionId,this.channelId=e.channelId,this.dt=i.dateFormat(new Date,"yyyy-MM-dd hh:mm:ss")}toString(){return this.uuid+"|"+this.uid+"|"+this.gameId+"|"+this.platId+"|"+this.regionId+"|"+this.channelId+"|"+this.dt}}class c extends p{constructor(e={},t={}){super(e),this.device=new r(e),this.level=t.level||0,this.reged=0,this.actionNumber=t.actionNumber||0}toString(){return"log_app_once|"+super.toString()+"|"+this.level+"|"+this.reged+"|"+this.device.toString()+"|"+this.actionNumber}}class g extends o{constructor(e,t){super(e,t),this.sequenceId=t.sequenceId||"",this.reason=t.reason||0,this.subReason=t.subReason||0}toString(){return super.toString()+"|"+this.sequenceId+"|"+this.reason+"|"+this.subReason}}class y extends g{constructor(e={},t={}){super(e,t),this.logType=t.logType||1,this.battleType=t.battleType||0,this.battleId=t.battleId||0,this.time=t.time||0}toString(){return"log_battle|"+super.toString()+"|"+this.logType+"|"+this.battleType+"|"+this.battleId+"|"+this.time}}class m extends g{constructor(e={},t={}){super(e,t),this.addOrReduce=t.addOrReduce||0,this.equipType=t.equipType||0,this.equipId=t.equipId||0,this.num=t.num||0}toString(){return"log_equip|"+super.toString()+"|"+this.addOrReduce+"|"+this.equipType+"|"+this.equipId+"|"+this.num}}class I extends g{constructor(e={},t={}){super(e,t),this.equipType=t.equipType||0,this.equipId=t.equipId||0,this.equipOldDegree=t.equipOldDegree||0,this.equipNewDegree=t.equipNewDegree||0,this.equipDegree=Math.abs(this.equipOldDegree-this.equipNewDegree)}toString(){return"log_equip_degree|"+super.toString()+"|"+this.equipType+"|"+this.equipId+"|"+this.equipOldDegree+"|"+this.equipNewDegree+"|"+this.equipDegree}}class w extends g{constructor(e={},t={}){super(e,t),this.equipType=t.equipType||0,this.equipId=t.equipId||0,this.equipOldLevel=t.equipOldLevel||0,this.equipNewLevel=t.equipNewLevel||0,this.equipLevel=Math.abs(this.equipOldLevel-this.equipNewLevel)}toString(){return"log_equip_level|"+super.toString()+"|"+this.equipType+"|"+this.equipId+"|"+this.equipOldLevel+"|"+this.equipNewLevel+"|"+this.equipLevel}}class q extends g{constructor(e={},t={}){super(e,t),this.equipType=t.equipType||0,this.equipId=t.equipId||0,this.equipOldLevel=t.equipOldLevel||0,this.equipNewLevel=t.equipNewLevel||0,this.equipLevel=Math.abs(this.equipOldLevel-this.equipNewLevel),this.playType=t.playType||0}toString(){return"log_equip_playway|"+super.toString()+"|"+this.equipType+"|"+this.equipId+"|"+this.equipOldLevel+"|"+this.equipNewLevel+"|"+this.equipLevel+"|"+this.playType}}class S extends g{constructor(e={},t={}){super(e,t),this.itemType=t.itemType||0,this.itemId=t.itemId||0,this.oldNum=t.oldNum||0,this.newNum=t.newNum||0,this.num=Math.abs(this.oldNum-this.newNum),this.addOrReduce=this.newNum>this.oldNum?1:0}toString(){return"log_item|"+super.toString()+"|"+this.addOrReduce+"|"+this.itemType+"|"+this.itemId+"|"+this.oldNum+"|"+this.newNum+"|"+this.num}}class v extends g{constructor(e={},t={}){super(e,t),this.heroId=t.heroId||0,this.newLevel=t.newLevel||0,this.num=Math.abs(this.newLevel-this.level)}toString(){return"log_level|"+super.toString()+"|"+this.heroId+"|"+this.newLevel+"|"+this.num}}class f extends g{constructor(e={},t={}){super(e,t),this.oldMoney=t.oldMoney||0,this.newMoney=t.newMoney||0,this.money=t.money||0,this.num=Math.abs(this.oldMoney-this.newMoney),this.addOrReduce=this.newMoney>this.oldMoney?1:0,this.moneyType=t.moneyType||0,this.itemIdName=t.itemIdName||"",this.itemType=t.itemType||0,this.itemId=t.itemId||"",this.shop=t.shop||0}toString(){return"log_money|"+super.toString()+"|"+this.oldMoney+"|"+this.newMoney+"|"+this.money+"|"+this.num+"|"+this.addOrReduce+"|"+this.itemType+"|"+this.itemIdName+"|"+this.itemType+"|"+this.itemId+"|"+this.shop}}class N extends g{constructor(e={},t={}){super(e,t),this.taskId=t.taskId||0,this.orderId=t.orderId||0}toString(){return"log_new_task|"+super.toString()+"|"+this.taskId+"|"+this.orderId}}class T extends n{constructor(e={},t={}){super(e),this.regDt=e.regDt||"",this.reged=0,this.level=t.level||0,this.vip=t.vip||0,this.payType=t.payType||1,this.orderNumber=t.orderNumber||"",this.dPrice=t.dPrice||0,this.dStoreNum=t.dStoreNum||0,this.totalNum=t.totalNum||0,this.fPayFlag=t.fPayFlag||0,this.payChannelId=t.payChannelId||0,this.payId=t.payId||"",this.payIdName=t.payIdName||"",this.dNum=t.dNum||0,this.dBeforeStoreNum=t.dBeforeStoreNum||0}toString(){return"log_pay|"+super.toString()+"|"+this.regDt+"|"+this.level+"|"+this.reged+"|"+this.vip+"|"+this.payType+"|"+this.orderNumber+"|"+this.dPrice+"|"+this.dStoreNum+"|"+this.totalNum+"|"+this.fPayFlag+"|"+this.payChannelId+"|"+this.payId+"|"+this.payIdName+"|"+this.dNum+"|"+this.dBeforeStoreNum}}class x extends g{constructor(e={},t={}){super(e,t),this.taskType=t.taskType||0,this.taskId=t.taskId||""}toString(){return"log_task|"+super.toString()+"|"+this.taskType+"|"+this.taskId}}var O=s(0),b=s.n(O);class L{constructor(e=1/0){this.concurrency=e,this.queue=[],this.tasks=[],this.activeCount=0}push(e){this.tasks.push(new Promise((t,s)=>{const i=()=>{this.activeCount++,e().then(e=>t(e)).catch(e=>s(e)).then(()=>this.next())};this.activeCount<this.concurrency?i():this.queue.push(i)}))}all(){return Promise.all(this.tasks)}next(){this.activeCount--,this.queue.length>0&&this.queue.shift()()}}function k(e){return(t,...s)=>new Promise((i,n)=>{e(Object.assign({},t,{success:i,fail:n}),...s)})}var M={request:k(wx.request),getSetting:k(wx.getSetting),getNetworkType:k(wx.getNetworkType),getShareInfo:k(wx.getShareInfo),getUserInfo:k(wx.getUserInfo)};class P{constructor(e){this.baseUrl=e}request(e,t,s){return M.request({url:this.baseUrl+t,data:s,method:e})}post(e,t){return this.request("POST",e,t)}}class D{constructor(e){this.sysInfo=e,this.queue=new L(5),this.request=new P(b.a.URL),this.queue.all(),this.sendReg=(e=>{this.sendX(new h(this.sysInfo,e).toString())}),this.sendLogin=(e=>{D.checkParam(e,"登录日志","type")&&this.sendX(new u(this.sysInfo,e).toString())}),this.sendSharedIn=(e=>{D.checkParam(e,"分享入日志 glSharedIn","type")&&this.sendX(new d(this.sysInfo,e).toString())}),this.sendSharedOut=(e=>{D.checkParam(e,"分享出日志 glSharedOut","type")&&this.sendX(new a(this.sysInfo,e).toString())}),this.sendAdVideo=(e=>{D.checkParam(e,"视频广告日志 glAdVideo","type","subType")&&this.sendX(new l(this.sysInfo,e).toString())}),this.sendAppOnce=(e=>{D.checkParam(e,"AppOnce日志 glAppOnce","actionNumber")&&this.sendX(new c(this.sysInfo,e).toString())}),this.sendBattle=(e=>{D.checkParam(e,"闯关日志 glBattle","logType","battleType","battleId")&&this.sendX(new y(this.sysInfo,e).toString())}),this.sendEquip=(e=>{D.checkParam(e,"装备日志 glEquip","sequenceId","reason","equipType","equipId","num","addOrReduce")&&this.sendX(new m(this.sysInfo,e).toString())}),this.sendEquipDegree=(e=>{D.checkParam(e,"装备升阶日志 glEquipDegree","equipType","equipId","equipOldDegree","equipNewDegree")&&this.sendX(new I(this.sysInfo,e).toString())}),this.sendEquipLevel=(e=>{D.checkParam(e,"装备升级日志 glEquipLevel","equipType","equipId","equipOldLevel","equipNewLevel")&&this.sendX(new w(this.sysInfo,e).toString())}),this.sendEquipPlayWay=(e=>{D.checkParam(e,"装备玩法日志 glEquipPlayWay","equipType","equipId","equipOldLevel","equipNewLevel","playType")&&this.sendX(new q(this.sysInfo,e).toString())}),this.sendItem=(e=>{D.checkParam(e,"道具日志 glItem","sequenceId","reason","itemType","itemId","oldNum","newNum")&&this.sendX(new S(this.sysInfo,e).toString())}),this.sendLevel=(e=>{D.checkParam(e,"升级日志 glLevel","level","newLevel")&&this.sendX(new v(this.sysInfo,e).toString())}),this.sendMoney=(e=>{D.checkParam(e,"money日志 glMoney","sequenceId","reason","oldMoney","newMoney","num","moneyType","itemIdName","itemType","itemId","shop")&&this.sendX(new f(this.sysInfo,e).toString())}),this.sendNewTask=(e=>{D.checkParam(e,"强制任务日志 glNewTask","taskId","orderId")&&this.sendX(new N(this.sysInfo,e).toString())}),this.sendPay=(e=>{D.checkParam(e,"充值日志 glPay","payType","orderNumber","dPrice","dStoreNum","totalNum","fPayFlag","dNum","dBeforeStoreNum")&&this.sendX(new T(this.sysInfo,e).toString())}),this.sendTask=(e=>{D.checkParam(e,"非强制任务日志 glTask","taskType","taskId")&&this.sendX(new x(this.sysInfo,e).toString())}),this.sendEvent=(e=>{this.sendX(e)})}sendX(e){this.queue.push(()=>this.request.post("",e).catch(e=>{console.warn("请求失败",e)}))}static checkParam(e={},t,...s){for(let i of s)if(!e.hasOwnProperty(i))return console.error(t,"缺少必要参数 ----\x3e",i),!1;return!0}sendLaunch(){wx.setStorageSync("GL_WX_FROM",this.sysInfo.channelId),this.sysInfo.isReg&&this.sendReg(),this.sendLogin({type:1})}}b.a.URL&&b.a.GAME&&b.a.REGION&&b.a.IOS&&b.a.ANDROID||console.error("leuok-log-sdk ------- 配置文件出错");let _={isReg:!1,gameId:b.a.GAME,regionId:b.a.REGION,uuid:"GL_UUID_DEFAULT",regDt:i.dateFormat(new Date,"yyyy-MM-dd hh:mm:ss"),platId:1,channelId:b.a.IOS};try{let t=wx.getStorageSync("GL_WX_UUID");t?Object.assign(_,t):(_.isReg=!0,_.uuid=i.getUUID(),_.regDt=i.dateFormat(new Date,"yyyy-MM-dd hh:mm:ss"),wx.setStorageSync("GL_WX_UUID",{uuid:_.uuid,regDt:_.regDt}))}catch(e){}try{let t=wx.getSystemInfoSync();t&&(Object.assign(_,t),_.platId=_.system.includes("iOS")?1:3,_.channelId=_.system.includes("iOS")?b.a.IOS:b.a.ANDROID)}catch(e){}let R=new D(_);wx.onShow(e=>{try{let t=wx.getStorageSync("GL_WX_FROM");if(t)R.sysInfo.channelId=t;else if(e.query.hasOwnProperty("glfrom")){if(_.system.includes("iOS"))return void M.request({url:`https://gw.gameley.com/gl-ms-ad-channel/api/channel?andChannelId=${e.query.glfrom}`,method:"GET"}).then(e=>{0===e.data.state&&(R.sysInfo.channelId=e.data.info.iosChannelId),R.sendLaunch()}).catch(e=>{R.sendLaunch()});R.sysInfo.channelId=e.query.glfrom}}catch(e){}R.sendLaunch()}),wx.onHide(()=>{R.sendLogin({type:0})}),wx.glSharedIn=R.sendSharedIn,wx.glSharedOut=R.sendSharedOut,wx.glAdVideo=R.sendAdVideo,wx.glEvent=R.sendEvent,wx.glAppOnce=R.sendAppOnce,wx.glBattle=R.sendBattle,wx.glEquip=R.sendEquip,wx.glEquipDegree=R.sendEquipDegree,wx.glEquipLevel=R.sendEquipLevel,wx.glEquipPlayWay=R.sendEquipPlayWay,wx.glItem=R.sendItem,wx.glLevel=R.sendLevel,wx.glMoney=R.sendMoney,wx.glNewTask=R.sendNewTask,wx.glPay=R.sendPay,wx.glTask=R.sendTask}]);